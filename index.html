<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>progcalc - Programmable RPN Calculator</title>
        <link rel="stylesheet" href="style.css" type="text/css">
    </head>
    <body>
        <div id="stack">
        </div>

        <div id="messages">OK</div>

        <textarea id="program">
// To use the calculator, type in commands into the prompt on the bottom
// right and press enter.
//
// You can type multiple commands at once by separating them with spaces - for
// example, this will compute the factorial of 5 and leave it on the stack:
//
//    "1 2 3 4 5 * * * *"
//
// In addition to some basic numeric functions, there are a few special
// commands:
//
// - You can reload the functions definitions in this window using "execute".
//
// - You can save the function definitions using "save". This uses localstorage,
//   so it will persist even if you leave the page.
//
// - You can load your saved function definitions into the editor, and evaluate
//   them, by using "load".

progcalc.register('+', (stack) => {
    const b = stack.pop();
    const a = stack.pop();
    stack.push(a + b);
});

progcalc.register('-', (stack) => {
    const b = stack.pop();
    const a = stack.pop();
    stack.push(a - b);
});

progcalc.register('++', (stack) => {
    const a = stack.pop();
    stack.push(a + 1);
});

progcalc.register('--', (stack) => {
    const a = stack.pop();
    stack.push(a - 1);
});

progcalc.register('*', (stack) => {
    const b = stack.pop();
    const a = stack.pop();
    stack.push(a * b);
});

progcalc.register('/', (stack) => {
    const b = stack.pop();
    const a = stack.pop();
    stack.push(a / b);
});

progcalc.register('neg', (stack) => {
    const a = stack.pop();
    stack.push(-a);
});

progcalc.register('dup', (stack) => {
    const a = stack.pop();
    stack.push(a);
    stack.push(a);
});

progcalc.register('drop', (stack) => {
    stack.pop();
});

progcalc.register('sum', (stack) => {
    let total = 0;
    while (!stack.empty()) {
        total += stack.pop();
    }
    stack.push(total);
});

progcalc.register('clear', (stack) => {
    while (!stack.empty()) {
        stack.pop();
    }
});</textarea>
        <input type="text" id="prompt">
    </body>

    <script src="progcalc.js"></script>
</html>
